Index: kursach_db/auth_profile/views.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.contrib.auth.forms import UserCreationForm\r\nfrom django.contrib.auth.models import User\r\nfrom django.contrib.auth.views import LoginView, LogoutView\r\nfrom django.http import HttpRequest\r\nfrom django.shortcuts import render, redirect, reverse\r\nfrom django.urls import reverse_lazy\r\nfrom django.views.generic import TemplateView, CreateView\r\n\r\nfrom .forms import ProfileForm\r\nfrom django.contrib.auth import authenticate, login, logout\r\n\r\nfrom .models import Profile\r\n\r\n\r\nclass LoginAuthView(LoginView):\r\n    template_name = \"auth.html\"\r\n\r\n    def get_success_url(self):\r\n        return reverse(\"auth:profile\")\r\n\r\n\r\nclass RegisterView(CreateView):\r\n    form_class = UserCreationForm\r\n    template_name = \"login_register.html\"\r\n    success_url = reverse_lazy(\"auth:profile\")\r\n\r\n    def form_valid(self, form):\r\n        response = super().form_valid(form)\r\n        Profile.objects.create(user=self.object)\r\n        username = form.cleaned_data.get(\"username\")\r\n        password = form.cleaned_data.get(\"password1\")\r\n        user = authenticate(\r\n            self.request,\r\n            username=username,\r\n            password=password,\r\n        )\r\n        login(request=self.request, user=user)\r\n        return response\r\n\r\n\r\nclass MyLogoutView(LogoutView):\r\n    next_page = reverse_lazy(\"auth:login\")\r\n\r\n\r\nclass AboutMeUpdateView(TemplateView):\r\n    template_name = \"auth_profile.html\"\r\n\r\n    def get(self, request, *args, **kwargs):\r\n        form = ProfileForm()\r\n        return self.render_to_response({'form': form})\r\n\r\n    def post(self, request: HttpRequest):\r\n        form = ProfileForm(request.POST, request.FILES, instance=Profile.objects.get(user=request.user))\r\n        if form.is_valid():\r\n            form.instance.user_id = request.user\r\n            profile_update = Profile.objects.get(user_id=request.user.id)\r\n            first_name = request.POST['first_name']\r\n            last_name = request.POST['last_name']\r\n            age = str(request.POST['age'])\r\n            passport = request.POST['passport']\r\n            passport_region = request.POST['passport_region']\r\n            study_type = request.POST['study_type']\r\n            study_place = request.POST['study_place']\r\n            try:\r\n                file = request.FILES['picture']\r\n                profile_update.picture.delete()\r\n                profile_update.picture = file\r\n            except:\r\n                pass\r\n            profile_update.last_name = last_name\r\n            profile_update.first_name = first_name\r\n            profile_update.age = age\r\n            profile_update.passport = passport\r\n            profile_update.passport_region = passport_region\r\n            profile_update.study_type = study_type\r\n            profile_update.study_place = study_place\r\n            # profile_update.save()\r\n            form.save()\r\n            return redirect(request.path)\r\n\r\n\r\nclass AboutMeView(TemplateView):\r\n    template_name = \"about_me.html\"\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/kursach_db/auth_profile/views.py b/kursach_db/auth_profile/views.py
--- a/kursach_db/auth_profile/views.py	
+++ b/kursach_db/auth_profile/views.py	
@@ -11,14 +11,6 @@
 
 from .models import Profile
 
-
-class LoginAuthView(LoginView):
-    template_name = "auth.html"
-
-    def get_success_url(self):
-        return reverse("auth:profile")
-
-
 class RegisterView(CreateView):
     form_class = UserCreationForm
     template_name = "login_register.html"
